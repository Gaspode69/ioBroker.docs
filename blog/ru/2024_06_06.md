---
title: 
translatedFrom: de
hash: /4+luard1k0CELgEud/w1uKxy4DBLNxA1VsR34yfliw=
---
# Адаптер JavaScript ioBroker: улучшения, апрель–май 2024 г.
В этом обзоре представлены наиболее важные изменения адаптера JavaScript версии 8.0.0.

**Особая благодарность Маттиасу Кляйне [*(маленькийИли)*](https://github.com/klein0r) за прекрасную работу над этим адаптером!**

## Новые функции и улучшения
**- Blockly:** многочисленные улучшения блоков Blockly, включая новые блоки для onLog, глобальных переменных, функций даты и времени и проверки сертификатов на httpGet.

Теперь вы можете реагировать на запись журнала в Blockly,

![onLog](en/blog/images/2024_06_06_onLog.png)

реагировать на изменение файла,

![onLog](en/blog/images/2024_06_06_onFile.png)

или немедленно подтвердить статус с помощью блочного триггера.

![onLog](en/blog/images/2024_06_06_ackState.png)

- **Безопасность:** введена защищенная область файловой системы («iobroker-data/files») для предотвращения прямого доступа к записи.

- **Совместимость:** теперь требуется поддержка Node.js >= 18.x и js-controller >= 5.

- **Функции сценариев:** Новые функции для временных файлов, сроков действия в Blockly и глобальных переменных.

Пример использования createTempFile:

```
httpGet('https://raw.githubusercontent.com/ioBroker/ioBroker.javascript/master/admin/javascript.png', { responseType: 'arraybuffer' }, async (err, response) => {
    if (err) {
        console.error(err);
    } else {
        const tempFilePath = createTempFile('javascript.png', response.data);
        console.log(`Saved to ${tempFilePath}`);

        // Use the new path in other scripts (e.g. sendTo)
    }
});

onFile('0_userdata.0', 'test.jpg', true, async (id, fileName, size, data, mimeType) => {
    const tempFilePath = createTempFile(fileName, response.data);

    // Use the new path in other scripts (e.g. sendTo)
});
```

- **Ведение журнала:** Улучшено ведение журнала с отображением информации об экземпляре и происхождении в окне журнала.

Старый формат журнала:

![onLog](en/blog/images/2024_06_06_old_logs.png)

Новый формат журнала:

![onLog](en/blog/images/2024_06_06_new_logs.png)

- **Генератор кода AI:** Возможность выбирать различные модели ChatGPT для генерации кода AI.

![onLog](en/blog/images/2024_06_06_ai.png)

- **Обратная совместимость:** удалена поддержка состояний с файлами (устарело, начиная с версии 6.2.0) и свойства запроса в песочнице (при необходимости модуль необходимо импортировать повторно).

- **Исправлены различные ошибки**

## Весь список изменений
Для использования новейших функций требуются NodeJS >= 18.x и js-controller >= 5.

Некоторые изменения затрагивают существующие скрипты (например, отсутствие поддержки состояний с файлами).

**8.0.0** (05.04.2024):

- Критическое изменение: удалена поддержка состояний с файлами (устарело с версии 6.2.0) *(small0r)*
- Критическое изменение: защищенная файловая система (iobroker-data/files) для предотвращения прямого доступа к записи *(small0r)*
- Критическое изменение: удалено свойство запроса песочницы (при необходимости модуль необходимо импортировать повторно) *(small0r)*
- Добавлен блок Blockly для глобальных переменных (например, имени скрипта) *(lowercase0r)*
- Добавлены недостающие функции для защитыФС *(small0r)*
- Исправлен httpPost (отсутствующие данные) *(small0r)*
- исправлен блок hasAttribute Blockly *(small0r)*
- Исправлена вставка скобок в Blockly для multi и or *(small0r)*
- добавлен setStateChanged/setStateChangedAsync *(PeterVoronov)*

**8.0.1** (08.04.2024):

- Исправлены некоторые недостающие переводы (украинский) *(small0r)*
— Поддержка версии ecma увеличена с es2021 до es2022 (Node.js 18) *(small0r)*

**8.0.2** (08.04.2024):

- Принудительное понижение версии клиента сокета (проблемы с изменением объектов) *(small0r)*

**8.0.3** (11 апреля 2024 г.):

- Обновлены зависимости (последняя версия адаптера-реакции-v5) *(small0r)*

**8.1.0** (03.05.2024):

- Конфигурация администратора обновлена до jsonConfig (Materialize удалена) *(bluefox)*

**8.1.1** (03.05.2024):

- Обновление изображений Blockly/JS и Rules/JS (в формате SVG) *(small0r)*

**8.2.0** (07.05.2024):

- добавлен toArray в объект результата селектора $ *(PeterVoronov)*
- Добавлен блок Blockly для onLog (small0r)

**8.3.0** (09.05.2024):

- добавлен createTempFile в песочницу *(small0r)*
- Исправлена ошибка в сообщении журнала при запуске скрипта *(small0r)*
- Добавлен экземпляр/источник в окно журнала (как в администраторе) *(small0r)*

**8.3.1** (13 мая 2024 г.):

- Разрешить отрицательные значения в форматеTimeDiff *(paul53)*
- Обновлены тесты и исправлены блочные переводы *(small0r)*

**8.4.0** (25 мая 2024 г.):

- Добавлены дополнительные проверки и предупреждения при некорректных подключениях Blockly *(small0r)*
- Добавлена возможность отключить проверку сертификата на httpGet *(small0r)*.
- Добавлена опция срока действия для блока Blockly *(small0r)*
- Исправлена ошибка с переменными.astro, когда дата недоступна *(small0r)*
- Исправлены ошибки в jsonConfig для библиотек и типизации библиотек *(small0r)*
- Реализованы новые возможности js-контроллера 6.x для управления пакетами *(small0r)*
- Обновление до ChatGPT-4o *(small0r)*

**8.4.1** (26 мая 2024 г.):

- Исправлен блок httpPost *(small0r)*

- Устаревшие соединения Blockly предупреждаются только один раз за запуск/использование скрипта *(small0r)*

**8.4.2** (28 мая 2024 г.):

- исправлено createState (удалены избыточные встроенные атрибуты) *(small0r)*

- Исправлена ошибка в пользовательском компоненте "astro" *(winnyschuster)*

**8.4.3** (04.06.2024):

- Добавлено время ответа на результат httpGet и httpPost (small0r).
- Добавлен триггерный блок для подтверждения новых значений (small0r)
- Разрешен выбор разных моделей ChatGPT для генератора кода AI (bluefox)