---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translatedFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/dev/adapter-dev-faq.md
title: Часто задаваемые вопросы по разработке адаптеров
hash: eYLJSbvcCz8wYyj3Pa+wrDSZhMY78b6yn9YUWmOxv0E=
---
# Часто задаваемые вопросы по разработке адаптеров
## Вступление
Идея этой страницы — собрать часто задаваемые вопросы о разработке адаптеров ioBroker.
Эта идея родилась у Ральфа в Discord-канале ioBroker #adapter 24 ноября 2020 года во время обсуждения вопроса Мика.

## Пожалуйста, внесите свой вклад (это очень просто!)
Не стесняйтесь добавлять любые вопросы и соответствующие ответы на этой странице. Единственное ограничение: не забудьте добавить дату к ответу. Не нужно перфекционизма, просто выкладывайте то, что помогло вам в разработке адаптера. Ссылки на адаптеры, в которых реализован вопрос, тоже очень приветствуются. Мы, разработчики, любим видеть примеры реализации :-)

*Примечание:* Это не будет официальной документацией. Любые подсказки, обходные пути, ссылки на еще более старые сообщения форума и т. д. приветствуются. Цель состоит в том, чтобы быстро поддерживать и помогать разработчикам по часто задаваемым вопросам разработчиков. Если у вас есть проблемы с написанием на английском языке здесь, пожалуйста, используйте свой местный язык, такой как немецкий, русский и т. д., мы будем рады помочь и перевести позже.

Для обновления оглавления вы можете использовать генератор TOC, например. [luciopaiva.com/markdown-toc](https://luciopaiva.com/markdown-toc/)

# Оглавление
- [Обновления адаптера](#adapter-updates)
  - [Публикация обновлений адаптера](#publishing-adapter-updates)
- [Тестирование адаптера и отчеты об ошибках](#adapter-testing-and-error-reporting)
  - [Компактный режим](#compact-mode)
  - [Часовой](#часовой)
- [Пользовательский интерфейс конфигурации адаптера (admin/index_m.html)](#adapter-configuration-ui-adminindexmhtml)
  - [Проверка ввода](#input-validation)
- [Функции адаптера](#функции-адаптера)
  - [Запись файлов](#запись-файлов)

---

### Обновления адаптера
#### Публикация обновлений адаптера
**Вопрос:** В каких файлах мне нужно изменить номер версии?

**Ответ:** По сути, вам нужно коснуться 3 файлов:

 * `io-package.json`: измените номер версии и добавьте журнал последних изменений.
 * `package.json`: изменить только номер версии
 * `README.md`: добавить новый номер версии и журнал изменений

Обратите внимание, что необходимо использовать [Семантическое управление версиями](https://semver.org/), см. [Управление версиями](https://github.com/ioBroker/ioBroker.docs/blob/master/docs/en/dev/adapterdev.md#versioning).<br> (25 ноября 2020 г.)

**Вопрос:** Мой адаптер находится в последнем репозитории. Я обновил адаптер на Github, а также опубликовал на NPM. Когда пользователи увидят новую версию в админке?

**Ответ:** ioBroker дважды в день проверяет наличие изменений версии.<br> (25 ноября 2020 г.)

**Вопрос:** Как добавить новый адаптер в последний репозиторий?

**Ответ:** См. [Добавить новый адаптер в последний репозиторий](https://github.com/ioBroker/ioBroker.repositories#add-a-new-adapter-to-the-latest-repository)<br> (25 ноября 2020 г.)

### Тестирование адаптера и отчеты об ошибках
#### Компактный режим
**Вопрос:** Как протестировать компактный режим?

**Ответ:** См. [Тестирование в компактном режиме](https://forum.iobroker.net/topic/32789/anleitung-f%C3%BCr-adapter-entwickler-compact-mode-testen) (на немецком языке)<br> (25 ноября 2020 г.)

#### Часовой
**Вопрос:** Как добавить Sentry к моему адаптеру?

**Ответ:** См. [Часовой Read.me](https://github.com/ioBroker/plugin-sentry#readme)<br> (25 ноября 2020 г.)

### Пользовательский интерфейс настройки адаптера (admin/index_m.html)
#### Проверка ввода
**Вопрос:** Я хочу проверить поля конфигурации адаптера, используя основные методы адаптера, а также классы/методы кода адаптера node.js. Проверка должна выполняться после того, как пользователь нажмет «сохранить» в конфигурации адаптера, после чего будет вызван `save()` из `admin/index_m.html`.

**Ответ:** Вы можете использовать метод `sendTo()` для отправки переменной `obj` из `admin/index_m.html` в код адаптера, проверить там содержимое, а затем предоставить результат через обратный вызов обратно в `sendTo()` из `admin/index_m.html`.<br> Пример: это реализовано в адаптере [Фарплан](https://github.com/gaudes/ioBroker.fahrplan).<br> ПРИМЕЧАНИЕ. Возможно, вам потребуется изменить `io-package.json`, см., например, [ioBroker-Forum: функция sendTo() недоступна](https://forum.iobroker.net/topic/5205/gel%C3%B6st-sendto-in-eigenem-adapter-funktioniert-nicht/)<br> (24 ноября 2020 г.)

### Функции адаптера
#### Запись файлов
**Вопрос:** Адаптер должен загрузить файл с axios и иметь возможность записать его в iobroker-data/files/<adapter>

**Ответ:** Вот небольшой фрагмент кода для этого действия:

```
const WebCall = await axios.get(url,{responseType: "arraybuffer"});
await Helper.Adapter.writeFileAsync(Helper.Adapter.namespace, `picture.jpg`, WebCall.data)
```

После этого в журнале ioBroker появилось предупреждение:<br> `writeFile will not write this file (picture.jpg) in future versions: <adapter> is not an object of type "meta"`<br> В io-package.json должен быть включен объект meta.user в instanceObjects:<br>

```
"instanceObjects": [
  {
    "_id": "",
    "type": "meta",
    "common": {
      "name": "User files for <Adapter>",
      "type": "meta.user"
    },
    "native": {}
  }
]
```

(09 декабря 2020 г.)
