---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translatedFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/adapterref/iobroker.gsmsms/README.md
title: ioBroker.gsmsms
hash: dunlSMGPp9mJWEwiLsW+jZKUNdPBGcuyXoTQ6r32bAY=
---
![Логотип](../../../en/adapterref/iobroker.gsmsms/admin/gsmsms.png)

![Количество установок](https://iobroker.live/badges/gsmsms-installed.svg)
![Текущая версия в стабильном репозитории.](https://iobroker.live/badges/gsmsms-stable.svg)
![НПМ-версия](https://img.shields.io/npm/v/iobroker.gsmsms.svg)
![Загрузки](https://img.shields.io/npm/dm/iobroker.gsmsms.svg)

# IoBroker.gsmsms
![Тестирование и выпуск](https://github.com/forelleblau/ioBroker.gsmsms/workflows/Test%20and%20Release/badge.svg)

##адаптер gsmsms для ioBroker
Отправляйте и получайте SMS с помощью GSM-оборудования.

## Аппаратное обеспечение
Любое GSM-оборудование (шилд, серфстик и т. д.), подключенное к последовательному порту вашего устройства ioBroker.
GSM-модулям/флешкам нужно много энергии. Пожалуйста, обеспечьте достаточный источник питания.

Некоторые устройства должны быть установлены в правильный режим для последовательной связи (см. «usb_modeswitch»).

## Настройки
### Настройка порта и подключения
#### Путь к последовательному порту — обязателен.
например `/dev/ttyUSB0` или `/dev/serial/by-id/xxxxxxxxxxx` (по идентификатору более стабильно, ttyUSBx может измениться при перезагрузке)

Некоторые устройства имеют несколько портов USB, поэтому, возможно, вам придется попробовать его. Скорее всего, «первый» будет работать, но, возможно, не будет доставлять «уведомления о входящих сообщениях», тогда вы можете попробовать другой, отправить смс и посмотреть, будет ли оно получено через несколько секунд (на Huawai это третий порт как пример).

#### PIN-код вашей SIM-карты
Если ваша SIM-карта защищена PIN-кодом, укажите PIN-код, и он будет использоваться для разблокировки SIM-карты во время инициализации (пустое значение означает «на SIM-карте нет PIN-кода»).

<!--

#### Режим подключения
##### Всегда открыт
Открывает модемное соединение сразу после запуска адаптера. Входящие и исходящие SMS доставляются мгновенно. SMS, поступившие в то время, когда адаптер не работает, будут доставлены следующим адаптером - запуском (в зависимости от емкости вашей SIM-карты).

##### Интервал получения
Исходящие SMS отправляются мгновенно. Входящие SMS поступают периодически в соответствии с заданным интервалом. Модемное соединение открывается только для отправки и получения SMS.

##### Только отправка
Адаптер используется только для отправки SMS. Все входящие SMS игнорируются (возможно, сохраняются на SIM-карте, но не передаются в адаптер).
-->

###Настройки GSM
Чтобы не исчерпать SIM-память, все SMS удаляются с SIM-карты после доставки/прочитания. Используйте, например. адаптер «история» для хранения ваших сообщений или любое другое удобное решение.

| Имя | Тип | По умолчанию | Описание |
| --------------------------- | ------- | ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Индикация входящего СМС | логическое | правда | Позволяет модему уведомлять о получении нового SMS-сообщения. |
| Включить конкатенацию | логическое | правда | Получайте объединенные сообщения как одно. |
| Пользовательская команда Iinit | строка | | Если вашему устройству требуется специальная команда инициализации, она может быть предоставлена и будет использоваться после проверки PIN-кода. то есть некоторым устройствам требуется «AT+CPMS="SM","SM","SM"', чтобы получить правильный набор памяти. Ожидается, что команда вернет `'OK'` (пусто, означает «нет специальной команды для инициализации»). Пожалуйста, ознакомьтесь со спецификациями вашего GSM-устройства. |
| CNMI, когда модем открыт/закрыт | строка | '2,1,0,2,0' / '2,0,2,2,1' | Определяет, сохраняются ли сообщения на SIM-карте или доставляются мгновенно. Пожалуйста, ознакомьтесь со спецификациями вашего GSM-устройства. |

<!--| Индикация входящего вызова | логическое | ложный | Получите событие `'onNewIncomingCall'` при приеме звонков. |-->

### Настройки последовательного порта
Пожалуйста, ознакомьтесь со спецификациями вашего GMS-устройства (Google поможет в большинстве случаев)

| Имя | Тип | По умолчанию | Описание |
| -------- | ------- | ------- | ------------------------------------------------------- |
| скорость передачи | номер | 19200 | Скорость передачи данных порта. |
| биты данных | номер | 8 | Должно быть одно из: 8, 7, 6 или 5. |
| стопбиты | номер | 1 | Должно быть одно из: 1 или 2. |
| паритет | строка | "нет" | Должно быть одно из: «нет», «чет», «отметка», «нечет», «пробел». |
| рццц | логическое | ложный | настройка управления потоком |
| ксон | логическое | ложный | настройка управления потоком |
| хофф | логическое | ложный | настройка управления потоком |
| Ксани | логическое | ложный | настройки управления потоком |

### Прочие настройки и рекомендации
#### Указывается как адаптер - объекты (`admin.x`)
— ваше имя (по умолчанию «ownNumber»), максимальная длина — 16 символов.
-   ваш номер телефона.
- Режим работы SMS («PDU» или «SMS», «PDU» используется по умолчанию и рекомендуется).

Все входные данные должны выполняться с параметром ack=false!

#### Входящие/Исходящие — История
Активировав адаптер истории для объекта `inbox.messageRaw` и объекта `sendSMS.messageRaw`, вы получаете полную информацию о входящих и исходящих сообщениях вашего SMS-трафика.

<!--

#### СМС - ошибки
Если возвращаются ошибки и ошибка возникла на устройстве (то есть обмен с устройством был технически успешным), то в сообщении об ошибке должен быть указан код ошибки, например. «+ОШИБКА CMS: 500». Сообщение об ошибке отображается в журнале на уровне предупреждения и сохраняется в объекте `info.error`.
(Неполный) список возможных кодов ошибок и их значений можно найти, например. по адресу <https://www.activexperts.com/sms-comComponent/gsm-error-codes/>.
-->

## Функциональные возможности
### Получить СМС
Входящие SMS записываются в объекты `inbox.*`. `inbox.messageRaw` можно использовать в качестве триггера для дальнейших операций (например, пересылка входящих SMS с помощью адаптера электронной почты).

### Отправить смс
Чтобы отправить SMS, введите `sendSMS.recipient, sendSMS.message` и дополнительно `sendSMS.alert` и нажмите кнопку `sendSMS.send` -. Или установите `sendSMS.messageRaw` — Объект со строкой в следующем виде и ack=false: `{"recipient": "Number", "message":"Yourtext", "alert":"false"}`.

Этот адаптер также предоставляет блок связи для функций блочного режима и отправки для других скриптов (sendTo("gsmsms._InstanceNo_", "send", {text: '_yourText_',recipient: '_phonenumber_', alert: '_false/true_'} );).

### Выполнение команд AT+
! Пожалуйста, обязательно знайте, что вы делаете при настройке команд AT+, это ваша SIM-карта/устройство.

AT+команды отправляются с установкой `admin.atCommandSLR` в формате `AT+XXXXy`.
Отправьте любую команду, которая вам нравится, но имейте в виду, что вы увидите только последнюю строку ответа.

## Серийный порт-GSM
Этот адаптер основан на [Плагин SerialPort-GSM](https://github.com/zabsalahid/serialport-gsm) для связи с GSM-модемами, в первую очередь для SMS.

## Руководство разработчика
Этот раздел предназначен для разработчика. Его можно будет удалить позже

### Начиная
Вы почти закончили, осталось всего несколько шагов:

1. Перейдите в [main.js](main.js) и начните программировать!

### Лучшие практики
Мы собрали некоторые [лучшие практики](https://github.com/ioBroker/ioBroker.repositories#development-and-coding-best-practices), касающиеся разработки и кодирования ioBroker в целом. Если вы новичок в ioBroker или Node.js, вам следует их проверить. Если у вас уже есть опыт, вам также стоит взглянуть на них — возможно, вы узнаете что-то новое :)

### Скрипты в `package.json`
Для вашего удобства предопределено несколько сценариев npm. Вы можете запустить их, используя `npm run <scriptname>`.

| Имя сценария | Описание |
\|-------------\|-------------\|
\| `test:js` | Выполняет тесты, определенные вами в файлах `*.test.js`. |
\| `test:package` | Гарантирует, что ваши `package.json` и `io-package.json` действительны. |
\| `test:unit` | Проверяет запуск адаптера с помощью модульных тестов (быстро, но для работы может потребоваться макет модуля). |
\| `test:integration` | Тестирует запуск адаптера с помощью реального экземпляра ioBroker. |
\| `test` | Выполняет минимальный тестовый запуск файлов пакета и ваших тестов. |
\| `check` | Выполняет проверку типа вашего кода (без компиляции). |
\| `lint` | Запускает `ESLint`, чтобы проверить ваш код на наличие ошибок форматирования и потенциальных ошибок. |
\| `release` | Создает новый выпуск, подробности см. в [`@alcalzone/release-script`](https://github.com/AlCalzone/release-script#usage). |

### Написание тестов
Если все сделано правильно, тестирование кода имеет неоценимую ценность, поскольку оно дает вам уверенность в том, что вы сможете изменить свой код, точно зная, когда что-то сломается. Полезную информацию по теме разработки через тестирование можно найти <https://hackernoon.com/introduction-to-test-driven-development-tdd-61a13bc92d92>.
Хотя написание тестов до написания кода может на первый взгляд показаться странным, но у этого есть очевидные преимущества.

Шаблон предоставляет базовые тесты для файлов запуска адаптера и пакетов.
Рекомендуется добавить в этот микс свои собственные тесты.

### Публикация адаптера
Используя действия GitHub, вы можете включить автоматические выпуски в npm всякий раз, когда вы отправляете новый тег git, соответствующий форме `v<major>.<minor>.<patch>`. Мы **настоятельно рекомендуем** это сделать. Необходимые шаги описаны в `.github/workflows/test-and-release.yml`.

Поскольку вы установили сценарий выпуска, вы можете создать новый выпуск, просто вызвав:

```bash
npm run release
```

Дополнительные параметры командной строки для сценария выпуска описаны в [документации сценария выпуска](<https://github.com/AlCalzone/release-script#command-line>).

Чтобы выпустить адаптер в ioBroker, обратитесь к документации [ioBroker.repositories](https://github.com/ioBroker/ioBroker.repositories#requirements-for-adapter-to-get-added-to-the-latest-repository).

### Проверьте адаптер вручную с помощью dev-сервера
Поскольку вы настроили `dev-server`, вы можете использовать его для запуска, тестирования и отладки вашего адаптера.

Вы можете запустить `dev-server`, вызвав из каталога разработки:

```bash
dev-server watch
```

Интерфейс ioBroker.admin будет доступен по адресу <http://localhost:8081/>.

Для получения более подробной информации обратитесь к [документация `dev-server`](https://github.com/ioBroker/dev-server#command-line).

## Changelog

<!--
	Placeholder for the next version (at the beginning of the line):
	### **WORK IN PROGRESS**
-->

### **WORK IN PROGRESS**

### 0.0.5

-   (forelleblau) bug fixed (adapter set "undefined" into state values)

### 0.0.4

-   (Apollon77) Optimizations, brush up to comply with ioBroker.repositories requirements

### 0.0.3

-   (forelleblau) dependencies updated, bugs fixed

### 0.0.2

-   (forelleblau) first published version

### 0.0.1

-   (forelleblau) initial release

## License

MIT License

Copyright (c) 2022-2023 forelleblau <mailto:marceladam@gmx.ch>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

<!--
